# DynamoDB Example Project

This project demonstrates building a very simple application that uses DynamoDB. Osiris does not have built-in support for DynamoDB. There are simply too many AWS services to support them all directly, so Osiris concentrates on making it easy to build the REST API. 

Other services must be configured manually using AWS CloudFormation. Osiris provides support for deploying these resources as a single atomic unit along with the REST API.

This manual resource defined in this project is a DynamoDB table, but the same concept applies to any AWS resource.

This project show three main concepts:

* Using the `root.template` file to define resources (the DynamoDB table)
* Adding permissions to the policy in `root.template` allowing the handler code to access the DynamoDB table
* Adding a DynamoDB client to the components and using it from the handler code

## The `root.template` File

If there is a file named `root.template` in the directory `src/main/cloudformation` then Osiris uses that as the main CloudFormation file in the deployment. `root.template` must refer to the generated CloudFormation file that defines the API and lambda. It must also define a role for the lambda that gives it the permissions required to access the resources defined in `root.template`.

The project generated by the Maven archetype contains a file `root.template.example` that can be used as the basis for creating `root.template`. It includes a role, a policy and a reference to the generated CloudFormation file.

## Permissions

The resource named `LambdaPolicy` in `root.template` grants permissions for the lambda to write logs and to read and write the DynamoDB table. This policy is attached to the `LambdaRole` resource that is passed to the generated CloudFormation template and used for the lambda.

When defining resources in `root.template` the required permissions should be added to this policy.

## DynamoDB Client

This project defines the type `DynamoExampleComponents` which provides the components used by the code that handles requests to the REST API endpoints. It has a single property `dynamoClient` that is used by the handlers for reading and writing data to DynamoDB.

This pattern should be followed for any components used by the handler code; the components should be defined as properties of the `ComponentsProvider` subtype used by the API.
